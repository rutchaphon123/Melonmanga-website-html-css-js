import { deattribute } from './deattribute.mjs';
import './error.mjs';
import './filterIncludes.mjs';
import { linkRelationships } from './linkRelationships.mjs';

function deserialiseArray(array) {
  for (let value of array.data) {
    if (array.included) value = linkRelationships(value, array.included);
    if (value.relationships) value = linkRelationships(value);
    if (value.attributes) value = deattribute(value);
    array.data[array.data.indexOf(value)] = value;
  }

  return array;
}

function deserialise(response) {
  var _response$data, _response$data2;

  if (!response) return;
  if (Array.isArray(response.data)) response = deserialiseArray(response);else if (response.included) response.data = linkRelationships(response.data, response.included);else if (((_response$data = response.data) === null || _response$data === void 0 ? void 0 : _response$data.constructor) === Object) response.data = linkRelationships(response.data);
  delete response.included;
  if ((_response$data2 = response.data) !== null && _response$data2 !== void 0 && _response$data2.attributes) response.data = deattribute(response.data);
  return response;
}

export { deserialise };
